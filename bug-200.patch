Fix bug 200.
Additional changes for 200
